 /* 
  * Script to show how to use Sequence acquisition 
  */ 

// file locations 
acqName = "test-Burst"; 
rootDirName = "D:\\Data\\Tong"; 

// Number of timepoints 
nrFrames = 500; 


// clear all previous acquisitions 
gui.closeAllAcquisitions(); 
gui.clearMessageWindow(); 
gui.openAcquisition(acqName, rootDirName, nrFrames, 1, 1); 

long width = mmc.getImageWidth(); 
long height = mmc.getImageHeight(); 
long depth = mmc.getBytesPerPixel(); 

gui.initializeAcquisition(acqName, (int) width, (int) height, (int) depth, 0); 

exposure = mmc.getExposure(); 
binning = mmc.getProperty(mmc.getCameraDevice(), "Binning"); 
print(binning);

mmc.startSequenceAcquisition(nrFrames, 0, false); 
frame = 0; 
now = System.currentTimeMillis(); 
while (mmc.getRemainingImageCount() > 0 || mmc.isSequenceRunning(mmc.getCameraDevice())) { 
   if (mmc.getRemainingImageCount() > 0) { 
      img = mmc.popNextTaggedImage(); 
      gui.addImageToAcquisition(acqName, frame, 0, 0, 0, img);
      frame++; 
   } 
} 

itTook = System.currentTimeMillis() - now; 

mmc.stopSequenceAcquisition(); 

gui.message("Acquisition took: " + itTook + " milliseconds"); 