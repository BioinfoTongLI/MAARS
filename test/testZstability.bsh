import java.util.ArrayList;
import java.io.FileWriter;
import util.opencsv.CSVWriter;
import util.opencsv.CSVWriter.NO_QUOTE_CHARACTER;

String focusDevice = mmc.getFocusDevice();
print(focusDevice);
double range = 1.2;
ArrayList outLines = new ArrayList();;
for (int speed = 1; speed < 10; speed++){
	for (int tolerance = 1; tolerance < 10; tolerance++){
		mmc.setProperty("TIZDrive", "Speed", speed);
		mmc.setProperty("TIZDrive", "Tolerance", tolerance);
		String label = String.valueOf(speed) + "_" + String.valueOf(tolerance);
		String[] onePosition = new String[101];
		zFocus = mmc.getPosition(focusDevice);
		while (zFocus > 1000.05 || zFocus < 999.95){
			mmc.setPosition(1000);
			mmc.waitForDevice(focusDevice);
			zFocus = mmc.getPosition(focusDevice);
		}
		print(label);
		for (int repete = 1; repete <= 100; repete++){
			double z = zFocus - (range / 2);
			onePosition[0] = label;
			for (int k = 0; k < 4; k++) {
				//print("- set focus device at position " + z);
				try {
					mmc.setPosition(focusDevice, z);
					mmc.waitForDevice(focusDevice);
				} catch (Exception e) {
					print("could not set focus device at position");
				}
				z = z + 0.4;
			}
			mmc.setPosition(1000);
			mmc.waitForDevice(focusDevice);
			onePosition[repete] = String.valueOf(mmc.getPosition(focusDevice));
		}
		outLines.add(onePosition);
	}	
}

FileWriter writer = new FileWriter("D:\\Data\\Tong\\test_60_0.csv");
CSVWriter csvwriter = new CSVWriter(writer, ',', CSVWriter.NO_QUOTE_CHARACTER);
csvwriter.writeAll(outLines);
csvwriter.close();