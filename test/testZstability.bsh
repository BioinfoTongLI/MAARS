import java.util.ArrayList;
import java.io.FileWriter;
import util.opencsv.CSVWriter;
import util.opencsv.CSVWriter.NO_QUOTE_CHARACTER;

String focusDevice = mmc.getFocusDevice();
print(focusDevice);
double range = 1.2;
ArrayList outLines = new ArrayList();;
for (int speed = 0; speed < 10; speed++){
	for (int tolerance = 0; tolerance < 10; tolerance++){
		//mmc.setProperty(label, propName, speed);
		//mmc.setProperty(label, propName, tolerance);
		String label = String.valueOf(speed) + "_" + String.valueOf(tolerance);
		zFocus = mmc.getPosition(focusDevice);
		double z = zFocus - (range / 2);
		String[] onePosition = new String[101];
		onePosition[0] = label;
		for (int repete = 1; repete <= 100; repete++){
			for (int k = 0; k < 3; k++) {
				//print("- set focus device at position " + z);
				try {
					mmc.setPosition(focusDevice, z);
					mmc.waitForDevice(focusDevice);
				} catch (Exception e) {
					print("could not set focus device at position");
				}
				z = z + 0.4;
			}
			onePosition[repete] = String.valueOf(mmc.getPosition(focusDevice));
		}
		mmc.setPosition(zFocus);
		outLines.add(onePosition);
	}	
}

FileWriter writer = new FileWriter("/home/tong/Documents/code/test.csv");
CSVWriter csvwriter = new CSVWriter(writer, ',', CSVWriter.NO_QUOTE_CHARACTER);
csvwriter.writeAll(outLines);
csvwriter.close();